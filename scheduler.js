
// async function myScheduledFunction() {
//     let res = await Prisma.$queryRaw`WITH LikeCounts AS (SELECT postId, COUNT(*) AS likeCount FROM 'Like' WHERE createdAt > '" + start_date + "' and createdAt < '" + end_date + "' GROUP BY postId), RepostCounts AS (SELECT postId, COUNT(*) AS repostCount FROM 'Repost' WHERE createdAt > '" + start_date + "' and createdAt < '" + end_date + "' GROUP BY postId), ReplyCounts AS (SELECT postId, COUNT(*) AS replyCount FROM Reply WHERE createdAt > '" + start_date + "' AND createdAt < '" + end_date + "' GROUP BY postId) SELECT l.id AS linkId, l.url, p.createdAt AS postCreatedAt, COALESCE(lc.likeCount, 0) AS likeCount, COALESCE(rc.repostCount, 0) AS repostCount, COALESCE(rp.replyCount, 0) AS replyCount FROM Link l LEFT JOIN Post p ON l.id = p.linkId LEFT JOIN LikeCounts lc ON p.did = lc.postId LEFT JOIN RepostCounts rc ON p.did = rc.postId LEFT JOIN ReplyCounts rp ON p.did = rp.postId WHERE (COALESCE(rc.repostCount, 0) >= 1 OR COALESCE(lc.likeCount, 0) >= 1 OR COALESCE(rp.replyCount, 0) >= 1) OR (p.createdAt > '" + start_date + "' and p.createdAt < '" + end_date + "')`
// }

// setInterval(myScheduledFunction, 300000);